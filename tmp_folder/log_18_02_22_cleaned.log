2022-02-18 16:51:45.196899: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
[INFO] Finished Importing
[INFO] Loading data...
[INFO] Loading inputs...
[INFO] Loading label...
[INFO] Input Data shape: (3767, 21505)

Variable sizes:
Input_spectra: (21504, 3761) - 308.52 MB
Input_magnitudes: (21504, 5) - 420.0 KB
Label_sfh: (21504, 17) - 1.39 MB
Label_z: (21504, 17) - 1.39 MB

Sizes of diferent sets (Train, Test)
[4m             |         train|          test[0m
Spect| (17203, 3761)|  (4301, 3761)
Magnitudes|    (17203, 5)|     (4301, 5)
SFH|   (17203, 17)|    (4301, 17)
Metallicity|   (17203, 17)|    (4301, 17)
param_grid {'epochs': [100, 150, 200], 'batch_size': [200, 300, 400], 'magn_neurons_first_layer': [32, 64], 'magn_number_layers': [2, 3], 'spect_neurons_first_layer': [128, 256, 512], 'spect_filter_size': [[30, 20, 10, 5], [30, 30, 10, 5], [50, 25, 10, 5], [30, 15, 10, 5], 15]}

epochs: [100, 150, 200] - 3
batch_size: [200, 300, 400] - 3
magn_neurons_first_layer: [32, 64] - 2
magn_number_layers: [2, 3] - 2
spect_neurons_first_layer: [128, 256, 512] - 3
spect_filter_size: [[30, 20, 10, 5], [30, 30, 10, 5], [50, 25, 10, 5], [30, 15, 10, 5], 15] - 5
[INFO] Number of possible combinations: 540

[INFO] THIS IS EVERYTHING THAT IS GOING TO GO INSIDE, THE PREVIOUS LINES ARE THE CORRECT ONES
estimator dict_keys(['model', 'build_fn', 'warm_start', 'random_state', 'optimizer', 'loss', 'metrics', 'batch_size', 'validation_batch_size', 'verbose', 'callbacks', 'validation_split', 'shuffle', 'run_eagerly', 'epochs', 'initial_learning_rate', 'train_size', 'test_size', 'cv', 'random_seed', 'traintestshuffle', 'loss_function_used', 'no_confirm', 'n_iter', 'data_path', 'data_sufix', 'output_model_path', 'output_name_grid', 'output_name_grid_result', 'output_name_best_estimator', 'output_name_model', 'output_name_parameters', 'spectra_prefix', 'magnitude_prefix', 'sfh_prefix', 'metal_prefix', 'spect_branch_type', 'spect_number_layers', 'spect_progression', 'spect_stride', 'spect_act', 'spect_pool_size', 'spect_dropout', 'spect_explicit', 'spect_output', 'spect_output_neurons', 'spect_final_act', 'spect_final_layer_name', 'spect_kernel_initializer', 'magn_branch_type', 'magn_progression', 'magn_act', 'magn_dropout', 'magn_explicit', 'magn_output', 'magn_output_neurons', 'magn_final_act', 'magn_final_layer_name', 'magn_kernel_initializer', 'sfh_branch_type', 'sfh_layers', 'sfh_act', 'sfh_dropout', 'sfh_explicit', 'sfh_output', 'sfh_output_neurons', 'sfh_final_act', 'sfh_final_layer_name', 'metal_branch_type', 'metal_layers', 'metal_act', 'metal_dropout', 'metal_explicit', 'metal_output', 'metal_output_neurons', 'metal_final_act', 'metal_final_layer_name', 'metal_kernel_initializer', 'config_file', 'reset_config_file', 'magn_neurons_first_layer', 'magn_number_layers', 'spect_neurons_first_layer', 'spect_filter_size'])
[INFO] Start training...
Fitting 3 folds for each of 10 candidates, totalling 30 fits
[INFO] Custom SMAPE is being used.
[INFO] Compiling model...
Epoch 1/100

39/39 [==============================] - 116s 3s/step - loss: 0.7783 - accuracy: 0.0583
Epoch 2/100

39/39 [==============================] - 113s 3s/step - loss: 0.3189 - accuracy: 0.0870
Epoch 3/100

39/39 [==============================] - 2004s 53s/step - loss: 0.1996 - accuracy: 0.1310
Epoch 4/100

39/39 [==============================] - 5686s 149s/step - loss: 0.1679 - accuracy: 0.1503
Epoch 5/100

39/39 [==============================] - 1446s 3s/step - loss: 0.1551 - accuracy: 0.1118
Epoch 6/100

39/39 [==============================] - 115s 3s/step - loss: 0.1261 - accuracy: 0.0903
Epoch 7/100

39/39 [==============================] - 114s 3s/step - loss: 0.1154 - accuracy: 0.1065
Epoch 8/100

39/39 [==============================] - 115s 3s/step - loss: 0.1114 - accuracy: 0.0868
Epoch 9/100

39/39 [==============================] - 115s 3s/step - loss: 0.0999 - accuracy: 0.1083
Epoch 10/100

39/39 [==============================] - 115s 3s/step - loss: 0.0934 - accuracy: 0.1039
Epoch 11/100

39/39 [==============================] - 115s 3s/step - loss: 0.0881 - accuracy: 0.1264
Epoch 12/100

39/39 [==============================] - 120s 3s/step - loss: 0.0853 - accuracy: 0.1207
Epoch 13/100

39/39 [==============================] - 120s 3s/step - loss: 0.0828 - accuracy: 0.1243
Epoch 14/100

39/39 [==============================] - 470s 12s/step - loss: 0.0828 - accuracy: 0.1268
Epoch 15/100

39/39 [==============================] - 1522s 40s/step - loss: 0.0782 - accuracy: 0.1327
Epoch 16/100

39/39 [==============================] - 6756s 155s/step - loss: 0.0792 - accuracy: 0.1259
Epoch 17/100

39/39 [==============================] - 5900s 155s/step - loss: 0.0760 - accuracy: 0.1314
Epoch 18/100

39/39 [==============================] - 2058s 54s/step - loss: 0.0740 - accuracy: 0.1459
Epoch 19/100

39/39 [==============================] - 118s 3s/step - loss: 0.0716 - accuracy: 0.1521
Epoch 20/100

39/39 [==============================] - 116s 3s/step - loss: 0.0714 - accuracy: 0.1481
Epoch 21/100

39/39 [==============================] - 118s 3s/step - loss: 0.0857 - accuracy: 0.1483
Epoch 22/100

39/39 [==============================] - 117s 3s/step - loss: 0.0715 - accuracy: 0.1667
Epoch 23/100

39/39 [==============================] - 119s 3s/step - loss: 0.0705 - accuracy: 0.1596
Epoch 24/100

39/39 [==============================] - 118s 3s/step - loss: 0.0686 - accuracy: 0.1640
Epoch 25/100

39/39 [==============================] - 121s 3s/step - loss: 0.0675 - accuracy: 0.1591
Epoch 26/100

39/39 [==============================] - 121s 3s/step - loss: 0.0658 - accuracy: 0.1668
Epoch 27/100

39/39 [==============================] - 121s 3s/step - loss: 0.0651 - accuracy: 0.1745
Epoch 28/100

39/39 [==============================] - 124s 3s/step - loss: 0.0649 - accuracy: 0.1877
Epoch 29/100

39/39 [==============================] - 2688s 71s/step - loss: 0.0678 - accuracy: 0.1740
Epoch 30/100

39/39 [==============================] - 5895s 155s/step - loss: 0.0701 - accuracy: 0.1770
Epoch 31/100

39/39 [==============================] - 6017s 158s/step - loss: 0.0666 - accuracy: 0.2191
Epoch 32/100

39/39 [==============================] - 8883s 234s/step - loss: 0.0659 - accuracy: 0.2084
Epoch 33/100

39/39 [==============================] - 149s 4s/step - loss: 0.0643 - accuracy: 0.1999
Epoch 34/100

39/39 [==============================] - 124s 3s/step - loss: 0.0624 - accuracy: 0.2204
Epoch 35/100

39/39 [==============================] - 126s 3s/step - loss: 0.0692 - accuracy: 0.2008
Epoch 36/100

39/39 [==============================] - 126s 3s/step - loss: 0.0638 - accuracy: 0.2012
Epoch 37/100

39/39 [==============================] - 4167s 110s/step - loss: 0.0626 - accuracy: 0.2148
Epoch 38/100

39/39 [==============================] - 8519s 224s/step - loss: 0.0621 - accuracy: 0.1986
Epoch 39/100

39/39 [==============================] - 2420s 63s/step - loss: 0.0596 - accuracy: 0.2238
Epoch 40/100

39/39 [==============================] - 321s 8s/step - loss: 0.0601 - accuracy: 0.2275
Epoch 41/100

39/39 [==============================] - 7399s 194s/step - loss: 0.0591 - accuracy: 0.2310
Epoch 42/100

39/39 [==============================] - 326s 8s/step - loss: 0.0593 - accuracy: 0.2313
Epoch 43/100

39/39 [==============================] - 7508s 197s/step - loss: 0.0588 - accuracy: 0.2204
Epoch 44/100

39/39 [==============================] - 331s 8s/step - loss: 0.0584 - accuracy: 0.2377
Epoch 45/100

39/39 [==============================] - 1528s 40s/step - loss: 0.0593 - accuracy: 0.2512
Epoch 46/100

39/39 [==============================] - 320s 8s/step - loss: 0.0575 - accuracy: 0.2215
Epoch 47/100

39/39 [==============================] - 222s 6s/step - loss: 0.0565 - accuracy: 0.2400
Epoch 48/100

39/39 [==============================] - 124s 3s/step - loss: 0.0567 - accuracy: 0.2531
Epoch 49/100

39/39 [==============================] - 125s 3s/step - loss: 0.0567 - accuracy: 0.2258
Epoch 50/100

39/39 [==============================] - 124s 3s/step - loss: 0.0561 - accuracy: 0.2664
Epoch 51/100

39/39 [==============================] - 121s 3s/step - loss: 0.0580 - accuracy: 0.2337
Epoch 52/100

39/39 [==============================] - 129s 3s/step - loss: 0.0561 - accuracy: 0.2533
Epoch 53/100

39/39 [==============================] - 128s 3s/step - loss: 0.0555 - accuracy: 0.2370
Epoch 54/100

39/39 [==============================] - 128s 3s/step - loss: 0.0536 - accuracy: 0.2513
Epoch 55/100

39/39 [==============================] - 9012s 237s/step - loss: 0.0568 - accuracy: 0.2520
Epoch 56/100

39/39 [==============================] - 122s 3s/step - loss: 0.0568 - accuracy: 0.2426
Epoch 57/100

39/39 [==============================] - 125s 3s/step - loss: 0.0558 - accuracy: 0.2713
Epoch 58/100

39/39 [==============================] - 123s 3s/step - loss: 0.0554 - accuracy: 0.2502
Epoch 59/100

39/39 [==============================] - 124s 3s/step - loss: 0.0555 - accuracy: 0.2663
Epoch 60/100

39/39 [==============================] - 125s 3s/step - loss: 0.0546 - accuracy: 0.2467
Epoch 61/100

39/39 [==============================] - 2006s 53s/step - loss: 0.0527 - accuracy: 0.2623
Epoch 62/100

39/39 [==============================] - 12630s 332s/step - loss: 0.0540 - accuracy: 0.2558
Epoch 63/100

39/39 [==============================] - 9891s 260s/step - loss: 0.0530 - accuracy: 0.2597
Epoch 64/100

39/39 [==============================] - 14683s 386s/step - loss: 0.0543 - accuracy: 0.2620
Epoch 65/100

39/39 [==============================] - 334s 9s/step - loss: 0.0517 - accuracy: 0.2764
Epoch 66/100

39/39 [==============================] - 7518s 198s/step - loss: 0.0511 - accuracy: 0.2599
Epoch 67/100

39/39 [==============================] - 331s 8s/step - loss: 0.0507 - accuracy: 0.2757
Epoch 68/100

39/39 [==============================] - 172s 4s/step - loss: 0.0516 - accuracy: 0.2833
Epoch 69/100

39/39 [==============================] - 10231s 269s/step - loss: 0.0509 - accuracy: 0.2703
Epoch 70/100

39/39 [==============================] - 323s 8s/step - loss: 0.0522 - accuracy: 0.2653
Epoch 71/100

39/39 [==============================] - 324s 8s/step - loss: 0.0522 - accuracy: 0.2510
Epoch 72/100

39/39 [==============================] - 7506s 197s/step - loss: 0.0514 - accuracy: 0.2856
Epoch 73/100

39/39 [==============================] - 323s 8s/step - loss: 0.0550 - accuracy: 0.2539
Epoch 74/100

39/39 [==============================] - 7511s 197s/step - loss: 0.0556 - accuracy: 0.2973
Epoch 75/100

39/39 [==============================] - 317s 8s/step - loss: 0.0540 - accuracy: 0.2573
Epoch 76/100

39/39 [==============================] - 2312s 61s/step - loss: 0.0506 - accuracy: 0.2801
Epoch 77/100

39/39 [==============================] - 317s 8s/step - loss: 0.0495 - accuracy: 0.2765
Epoch 78/100

39/39 [==============================] - 4242s 111s/step - loss: 0.0495 - accuracy: 0.2894
Epoch 79/100

39/39 [==============================] - 322s 8s/step - loss: 0.0533 - accuracy: 0.2795
Epoch 80/100

39/39 [==============================] - 321s 8s/step - loss: 0.0529 - accuracy: 0.2663
Epoch 81/100

39/39 [==============================] - 6787s 178s/step - loss: 0.0498 - accuracy: 0.2915
Epoch 82/100

39/39 [==============================] - 6941s 183s/step - loss: 0.0507 - accuracy: 0.2752
Epoch 83/100

39/39 [==============================] - 23272s 612s/step - loss: 0.0489 - accuracy: 0.2769
Epoch 84/100

39/39 [==============================] - 7382s 194s/step - loss: 0.0496 - accuracy: 0.2916
Epoch 85/100

39/39 [==============================] - 122s 3s/step - loss: 0.0473 - accuracy: 0.2845
Epoch 86/100

39/39 [==============================] - 120s 3s/step - loss: 0.0490 - accuracy: 0.3055
Epoch 87/100

39/39 [==============================] - 124s 3s/step - loss: 0.0480 - accuracy: 0.2990
Epoch 88/100

39/39 [==============================] - 124s 3s/step - loss: 0.0485 - accuracy: 0.2894
Epoch 89/100

39/39 [==============================] - 123s 3s/step - loss: 0.0493 - accuracy: 0.3009
Epoch 90/100

39/39 [==============================] - 730s 19s/step - loss: 0.0488 - accuracy: 0.2956
Epoch 91/100

39/39 [==============================] - 2102s 55s/step - loss: 0.0498 - accuracy: 0.3028
Epoch 92/100

39/39 [==============================] - 13555s 356s/step - loss: 0.0492 - accuracy: 0.2831
Epoch 93/100

39/39 [==============================] - 123s 3s/step - loss: 0.0486 - accuracy: 0.3001
Epoch 94/100

s_total: 238891
m_total: 3981.516666666667
h_total: 66.35861111111112
